<!DOCTYPE html>
<html>
<head>
	<script src="https://cdn.bootcss.com/echarts/3.7.0/echarts.common.js"></script>
	<meta charset="utf-8">
	<style>
	   .div_main{
	   	  width:80%;
	   	  margin-top:30px;
	   	  margin-left:10%;
	   	  height:2000px;
	   }
	   .div_chart{
	   	  width:100%;
	   	  height:500px;
	   }
	</style>
    <title>Goddy</title>
</head>
<body>
    <body>
	    <div id="main" class="div_main">
	       <div id="chart" class="div_chart">
	    </div>
	    <script type="text/javascript">
	        // 基于准备好的dom，初始化echarts实例
	        var myChart = echarts.init(document.getElementById('chart'));
	        var xAxisData=["01-01","01-02","01-03","01-04","01-05","01-06","01-07"];
	        var yAxisData=[20,23, 15, 26, 50, 28, 22];
	        var eventsData=[
				    {
				        "date": "01-03",
				        "content": "去食堂"
				    },
				    {
				        "date": "01-05",
				        "content": "下馆子"
				    }]
		    //配置事件属性
		    var events=[]
		    var bottomIncrease=20;
		    var bottomIncreaseNum=40;
		    for(var i in eventsData){
		    	var event={
		    		type: 'group',
	                bottom: 0,
	                children: [{
	                    type: 'rect',
	                    left: 'center',
	                    top: 'middle',
	                    z:1,
	                    shape: {
	                        width: 180,
	                        height: 56
	                    },
	                    style: {
	                        fill: '',
	                        lineWidth: 2,
	                        shadowBlur: 8,
	                        shadowOffsetX: 3,
	                        shadowOffsetY: 3,
	                        shadowColor: ''
	                    }
	                }, {
	                    type: 'text',
	                    left: 'center',
	                    top: 'middle',
	                    z:1,
	                    style: {
	                        fill: '#fff',
	                        text: '',
	                        font: '18px Microsoft YaHei'
	                    }
	                }]
		    	}
		    	event.time=eventsData[i].date;
		    	function getRandomColor() {
	                var r = Math.floor(Math.random() * 256);
	                var g = Math.floor(Math.random() * 256);
	                var b = Math.floor(Math.random() * 256);
	                return "rgba(" + r + ',' + g + ',' + b + ',0.5' + ")";
	            }
	            event.children[0].style.fill = getRandomColor();
	            event.children[1].style.text= eventsData[i].content;
	            event.bottom = bottomIncrease;
	            bottomIncrease = bottomIncrease + bottomIncreaseNum;
	            events.push(event);
		    }
		    //定义找时间差的方法
		    var timeCompare=function(time1,time2){
		    	var time1S=time1.split('-')[1];
		    	var time2S=time2.split('-')[1];
		    	return (time1S*1-time2S*1);
		    }
		    // console.log(timeCompare('01-02','01-01'))
		    //找出事件位置,方法b
		    var xStart = 20,
            xEnd = document.getElementById('chart').offsetWidth-20; 
		    var dateStart=xAxisData[0];
		    var dateEnd=xAxisData[xAxisData.length-1];
		    var dateChange=timeCompare(dateEnd,dateStart);
		    var eventWidth = events[0].children[0].shape.width;
		    for(var i in eventsData){
		    	var x=timeCompare(eventsData[i].date,dateStart);
		    	events[i].left=x/dateChange* (xEnd - xStart) + xStart- eventWidth / 2;
		    }
		    


	        // 指定图表的配置项和数据
	        var option = {
	            title: {
	                text: '每日消费',
	                x: 'center'
	            },
	            tooltip: {},
	            grid:{
	            	left:'20',
	            	right:'20',
	            	bottom:'20'
	            },
	            legend: {
	                data:['午饭'],
	                x: '100'
	            },
	            xAxis: {
	                data: xAxisData,
	                boundaryGap : false
	            },
	            yAxis: {
	            	name:'元'
	            },
	            series: [{
	                name: '午饭',
	                type: 'line',
	                data: yAxisData
	            }],
	            graphic:events
	        };

	        // 使用刚指定的配置项和数据显示图表。
	        myChart.setOption(option);
	    </script>
	</body>
</body>
</html>